<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>ê°ë„ ì‚¬ëƒ¥ ê²Œì„</title>
  <style>
    :root {
      --bg1: #c4e0ff;
      --bg2: #fce1ff;
      --card-bg: rgba(255, 255, 255, 0.85);
      --accent: #6366f1;
      --accent-soft: rgba(99, 102, 241, 0.15);
      --accent-2: #22c55e;
      --danger: #f97373;
      --text-main: #1f2933;
      --text-sub: #6b7280;
      --shadow-soft: 0 18px 40px rgba(15, 23, 42, 0.18);
      --radius-lg: 22px;
    }

    * {
      box-sizing: border-box;
      font-family: "Pretendard", system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
    }

    body {
      margin: 0;
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      background: radial-gradient(circle at 0% 0%, #d1fae5 0, transparent 55%),
                  radial-gradient(circle at 100% 0%, #bfdbfe 0, transparent 55%),
                  linear-gradient(135deg, var(--bg1), var(--bg2));
      color: var(--text-main);
      padding: 20px;
    }

    .bubble {
      position: fixed;
      border-radius: 999px;
      filter: blur(20px);
      opacity: 0.35;
      z-index: 0;
    }

    .bubble.b1 {
      width: 240px;
      height: 240px;
      background: #a5b4fc;
      top: 10%;
      left: 8%;
    }
    .bubble.b2 {
      width: 280px;
      height: 280px;
      background: #f9a8d4;
      bottom: 8%;
      right: 10%;
    }

    .card {
      position: relative;
      z-index: 1;
      background: radial-gradient(circle at top left, rgba(255,255,255,0.85), rgba(255,255,255,0.7));
      backdrop-filter: blur(18px) saturate(150%);
      -webkit-backdrop-filter: blur(18px) saturate(150%);
      border-radius: var(--radius-lg);
      box-shadow: var(--shadow-soft);
      border: 1px solid rgba(255, 255, 255, 0.7);
      max-width: 900px;
      width: 100%;
      padding: 24px 26px 20px;
      display: grid;
      grid-template-columns: minmax(0, 1.1fr) minmax(0, 1fr);
      gap: 20px;
    }

    @media (max-width: 760px) {
      .card {
        grid-template-columns: 1fr;
      }
    }

    .header {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-bottom: 8px;
    }

    .logo-circle {
      width: 40px;
      height: 40px;
      border-radius: 999px;
      background: conic-gradient(from 160deg, #fbbf24, #22c55e, #38bdf8, #f97316, #fbbf24);
      padding: 2px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .logo-inner {
      width: 100%;
      height: 100%;
      border-radius: inherit;
      background: radial-gradient(circle at 30% 30%, #ffffff, #e0f2fe);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 22px;
    }

    h1 {
      margin: 0;
      font-size: 1.4rem;
      display: flex;
      flex-direction: column;
      line-height: 1.2;
    }

    h1 span.small {
      font-size: 0.8rem;
      color: var(--text-sub);
      font-weight: 500;
    }

    .tag-row {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      margin-bottom: 14px;
    }

    .tag {
      font-size: 0.75rem;
      padding: 4px 10px;
      border-radius: 999px;
      background: rgba(255,255,255,0.8);
      border: 1px solid rgba(148, 163, 184, 0.4);
      color: #4b5563;
      display: inline-flex;
      align-items: center;
      gap: 4px;
    }

    .tag-emoji {
      font-size: 0.8rem;
    }

    .info-box {
      font-size: 0.82rem;
      background: linear-gradient(135deg, rgba(129, 140, 248, 0.16), rgba(56, 189, 248, 0.12));
      border-radius: 14px;
      padding: 10px 12px;
      color: #1e293b;
      border: 1px solid rgba(129, 140, 248, 0.4);
      margin-bottom: 18px;
    }

    .info-box strong {
      font-weight: 700;
    }

    .pane-title {
      font-size: 0.9rem;
      font-weight: 600;
      color: var(--text-sub);
      text-transform: uppercase;
      letter-spacing: 0.06em;
      margin-bottom: 6px;
    }

    .game-panel {
      background: rgba(255,255,255,0.75);
      border-radius: 18px;
      padding: 14px 16px 16px;
      border: 1px solid rgba(209, 213, 219, 0.7);
    }

    .row-space {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
      margin-bottom: 10px;
      flex-wrap: wrap;
    }

    .difficulty-group {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
    }

    .chip {
      border-radius: 999px;
      padding: 6px 12px;
      font-size: 0.8rem;
      border: 1px solid rgba(148, 163, 184, 0.65);
      background: rgba(248, 250, 252, 0.9);
      color: #111827;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      transition: all 0.18s ease;
    }

    .chip input {
      display: none;
    }

    .chip.active {
      border-color: rgba(99, 102, 241, 0.9);
      background: radial-gradient(circle at 20% 0%, rgba(129, 140, 248, 0.22), rgba(255, 255, 255, 0.9));
      color: #111827;
      box-shadow: 0 8px 16px rgba(79, 70, 229, 0.24);
    }

    .target-box {
      margin-top: 6px;
      padding: 10px 12px;
      border-radius: 14px;
      background: rgba(248, 250, 252, 0.85);
      border: 1px dashed rgba(148, 163, 184, 0.9);
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 10px;
      font-size: 0.95rem;
    }

    .target-angle {
      font-size: 1.1rem;
      font-weight: 700;
      color: var(--accent);
    }

    .target-angle span.big {
      font-size: 1.4rem;
    }

    .pill {
      font-size: 0.78rem;
      padding: 4px 8px;
      border-radius: 999px;
      background: rgba(226, 232, 240, 0.9);
      color: #475569;
    }

    canvas {
      width: 100%;
      max-width: 360px;
      background: radial-gradient(circle at 30% 0%, rgba(255,255,255,0.95), rgba(226,232,240,0.95));
      border-radius: 16px;
      margin: 10px auto 8px;
      display: block;
      border: 1px solid rgba(148,163,184,0.5);
      box-shadow: 0 10px 20px rgba(15,23,42,0.12);
    }

    .slider-row {
      margin-top: 6px;
    }

    .slider-row label {
      display: flex;
      justify-content: space-between;
      font-size: 0.85rem;
      color: var(--text-sub);
      margin-bottom: 4px;
    }

    .slider-value {
      font-weight: 600;
      color: #111827;
    }

    .slider-wrapper {
      position: relative;
      padding: 6px 4px 2px;
      border-radius: 999px;
      background: linear-gradient(90deg, rgba(129, 140, 248, 0.3), rgba(56, 189, 248, 0.3));
    }

    input[type="range"] {
      width: 100%;
      -webkit-appearance: none;
      appearance: none;
      background: transparent;
      cursor: pointer;
      height: 30px;
    }

    input[type="range"]::-webkit-slider-runnable-track {
      height: 6px;
      background: rgba(255, 255, 255, 0.9);
      border-radius: 999px;
    }

    input[type="range"]::-moz-range-track {
      height: 6px;
      background: rgba(255, 255, 255, 0.9);
      border-radius: 999px;
    }

    input[type="range"]::-webkit-slider-thumb {
      -webkit-appearance: none;
      appearance: none;
      width: 18px;
      height: 18px;
      border-radius: 999px;
      background: radial-gradient(circle at 30% 30%, #ffffff, #e5e7eb);
      border: 2px solid #6366f1;
      margin-top: -6px;
      box-shadow: 0 4px 10px rgba(79, 70, 229, 0.35);
    }

    input[type="range"]::-moz-range-thumb {
      width: 18px;
      height: 18px;
      border-radius: 999px;
      background: radial-gradient(circle at 30% 30%, #ffffff, #e5e7eb);
      border: 2px solid #6366f1;
      box-shadow: 0 4px 10px rgba(79, 70, 229, 0.35);
    }

    .btn-row {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-top: 10px;
    }

    .btn {
      border: none;
      border-radius: 999px;
      padding: 8px 14px;
      font-size: 0.85rem;
      font-weight: 600;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      transition: transform 0.12s ease, box-shadow 0.12s ease, background 0.15s ease;
      white-space: nowrap;
    }

    .btn.main {
      background: linear-gradient(135deg, #4f46e5, #6366f1);
      color: #f9fafb;
      box-shadow: 0 10px 18px rgba(79, 70, 229, 0.45);
    }

    .btn.sub {
      background: rgba(255, 255, 255, 0.92);
      color: #111827;
      border: 1px solid rgba(148, 163, 184, 0.6);
    }

    .btn.ghost {
      background: transparent;
      color: #4b5563;
      border: 1px dashed rgba(148, 163, 184, 0.8);
    }

    .btn:hover {
      transform: translateY(-1px);
      box-shadow: 0 10px 20px rgba(15, 23, 42, 0.25);
      filter: brightness(1.03);
    }

    .btn:active {
      transform: translateY(1px) scale(0.98);
      box-shadow: 0 5px 10px rgba(15, 23, 42, 0.25);
    }

    .status-box {
      margin-top: 10px;
      padding: 10px 12px;
      border-radius: 14px;
      background: var(--accent-soft);
      border: 1px solid rgba(129, 140, 248, 0.7);
      font-size: 0.85rem;
      color: #1e293b;
    }

    .status-title {
      font-weight: 700;
      margin-bottom: 4px;
      display: flex;
      align-items: center;
      gap: 4px;
    }

    .status-detail {
      display: flex;
      justify-content: space-between;
      font-size: 0.82rem;
      margin-top: 4px;
    }

    .status-detail span {
      display: inline-flex;
      align-items: center;
      gap: 4px;
    }

    .right-panel {
      background: linear-gradient(145deg, rgba(255,255,255,0.95), rgba(239,246,255,0.9));
      border-radius: 18px;
      padding: 14px 16px 14px;
      border: 1px solid rgba(148, 163, 184, 0.5);
      box-shadow: 0 10px 20px rgba(15,23,42,0.12);
      backdrop-filter: blur(14px);
      -webkit-backdrop-filter: blur(14px);
    }

    .right-panel h2 {
      font-size: 0.95rem;
      margin: 0 0 8px;
    }

    .tip-list {
      margin: 0;
      padding-left: 18px;
      font-size: 0.8rem;
      color: #4b5563;
    }

    .tip-list li {
      margin-bottom: 4px;
    }

    .badge-row {
      display: flex;
      gap: 6px;
      flex-wrap: wrap;
      margin: 8px 0;
    }

    .badge {
      font-size: 0.76rem;
      padding: 4px 8px;
      border-radius: 999px;
      background: rgba(209, 250, 229, 0.9);
      border: 1px solid rgba(52, 211, 153, 0.7);
      color: #064e3b;
      display: inline-flex;
      align-items: center;
      gap: 4px;
    }

    .score-badge {
      font-size: 0.78rem;
      padding: 4px 10px;
      border-radius: 999px;
      background: rgba(251, 191, 36, 0.12);
      border: 1px solid rgba(245, 158, 11, 0.7);
      color: #92400e;
      display: inline-flex;
      align-items: center;
      gap: 4px;
      margin-top: 4px;
    }

    .highlight {
      color: var(--accent-2);
      font-weight: 700;
    }

    .status-good {
      color: var(--accent-2);
      font-weight: 700;
    }

    .status-okay {
      color: #f59e0b;
      font-weight: 700;
    }

    .status-bad {
      color: var(--danger);
      font-weight: 700;
    }
  </style>
</head>
<body>
  <div class="bubble b1"></div>
  <div class="bubble b2"></div>

  <main class="card">
    <section>
      <div class="header">
        <div class="logo-circle">
          <div class="logo-inner">âˆ </div>
        </div>
        <h1>
          ê°ë„ ì‚¬ëƒ¥ ê²Œì„
          <span class="small">Drag &amp; Hunt Â· ì´ˆë“± 4í•™ë…„ ê°ë„ ê°ê° í‚¤ìš°ê¸°</span>
        </h1>
      </div>

      <div class="tag-row">
        <span class="tag"><span class="tag-emoji">ğŸ¯</span>ëª©í‘œ ê°ë„ì— ìµœëŒ€í•œ ê°€ê¹ê²Œ!</span>
        <span class="tag"><span class="tag-emoji">ğŸ“</span>ê°ë„ í¬ê¸° Â· ì˜ˆê°/ë‘”ê° Â· ì§ê° ê°œë…</span>
        <span class="tag"><span class="tag-emoji">ğŸ‘€</span>ëˆˆëŒ€ì¤‘ + ì¶”ë¡  í›ˆë ¨</span>
      </div>

      <div class="info-box">
        <strong>ê²Œì„ ì„¤ëª…</strong><br />
        ëª©í‘œ ê°ë„ê°€ ì£¼ì–´ì§€ë©´, ìŠ¬ë¼ì´ë”ë¥¼ ì›€ì§ì—¬ ë‚´ ê°ë„ë¥¼ ì¡°ì ˆí•´ ë³´ì„¸ìš”.  
        ì •ë‹µê³¼ì˜ ì°¨ì´ê°€ ì‘ì„ìˆ˜ë¡ ë†’ì€ ì ìˆ˜! ì•„ì´ë“¤ê³¼ â€œì˜ˆê°/ì§ê°/ë‘”ê°ì€ ì–´ëŠ ìª½ì¸ì§€â€ ê°™ì´ ì´ì•¼ê¸°í•˜ë©° í™œìš©í•´ ë³´ì„¸ìš”.
      </div>

      <div class="pane-title">Game Panel</div>
      <div class="game-panel">
        <div class="row-space">
          <div>
            <div style="font-size:0.85rem; color:var(--text-sub); margin-bottom:2px;">ë‚œì´ë„ ì„ íƒ</div>
            <div class="difficulty-group" id="difficultyGroup">
              <label class="chip active">
                <input type="radio" name="difficulty" value="easy" checked />
                ğŸŒ± ì´ˆê¸‰ (10ë„ ë‹¨ìœ„)
              </label>
              <label class="chip">
                <input type="radio" name="difficulty" value="normal" />
                ğŸŒ¿ ì¤‘ê¸‰ (5ë„ ë‹¨ìœ„)
              </label>
              <label class="chip">
                <input type="radio" name="difficulty" value="hard" />
                ğŸŒ³ ê³ ê¸‰ (1ë„ ë‹¨ìœ„)
              </label>
            </div>
          </div>
          <button class="btn sub" id="btnNew">
            ğŸ”„ ìƒˆ ë¯¸ì…˜
          </button>
        </div>

        <div class="target-box">
          <div>
            <div style="font-size:0.8rem; color:var(--text-sub);">ì´ë²ˆ ë¯¸ì…˜</div>
            <div class="target-angle" id="targetAngleText">
              ğŸ¯ ëª©í‘œ ê°ë„: <span class="big">â€”</span>
            </div>
          </div>
          <div class="pill">
            0Â°ëŠ” ì˜¤ë¥¸ìª½, ìœ„ë¡œ ê°ˆìˆ˜ë¡ ê°ë„ â†‘
          </div>
        </div>

        <canvas id="angleCanvas" width="360" height="260"></canvas>

        <div class="slider-row">
          <label>
            <span>ë‚´ê°€ ë§Œë“  ê°ë„</span>
            <span class="slider-value" id="currentAngleLabel">0Â°</span>
          </label>
          <div class="slider-wrapper">
            <input type="range" id="angleSlider" min="0" max="180" value="0" />
          </div>
        </div>

        <div class="btn-row">
          <button class="btn main" id="btnCheck">
            âœ… ì •ë‹µ í™•ì¸
          </button>
          <button class="btn ghost" id="btnShowAnswer">
            ğŸ‘ ì •ë‹µ ë³´ê¸°
          </button>
          <button class="btn sub" id="btnResetRound">
            â™» ì´ë²ˆ íŒ ë‹¤ì‹œ
          </button>
        </div>

        <div class="status-box" id="statusBox">
          <div class="status-title">
            <span id="statusEmoji">ğŸ’¡</span>
            <span id="statusTitle">ìŠ¬ë¼ì´ë”ë¥¼ ì›€ì§ì—¬ ê°ë„ë¥¼ ë§Œë“¤ì–´ ë³´ì„¸ìš”!</span>
          </div>
          <div id="statusText" style="font-size:0.8rem; margin-top:4px;">
            ëª©í‘œ ê°ë„ëŠ” ì•„ì§ ë¹„ë°€ì´ì—ìš”. â€œì˜ˆê°ì¸ê°€, ë‘”ê°ì¸ê°€?â€ ë¨¼ì € ì§ì‘í•´ ë³´ì„¸ìš”.
          </div>
          <div class="status-detail">
            <span>ì´ë²ˆ íŒ ê²°ê³¼: <span id="statusDiff">â€”</span></span>
            <span>ëˆ„ì  ê¸°ë¡: <span id="statusScore">0íŒ ì§„í–‰</span></span>
          </div>
        </div>
      </div>
    </section>

    <aside class="right-panel">
      <h2>êµì‚¬ìš© TIP & í™œìš© ì•„ì´ë””ì–´</h2>
      <ul class="tip-list">
        <li>ìŠ¬ë¼ì´ë”ë¥¼ ì ê¹ ë©ˆì¶”ê²Œ í•˜ê³ , <strong>â€œì§€ê¸ˆ ì˜ˆê°/ì§ê°/ë‘”ê° ì¤‘ ë­ ê°™ì•„?â€</strong> ì§ˆë¬¸í•´ ë³´ì„¸ìš”.</li>
        <li>ì•„ì´ë“¤ë¼ë¦¬ ëŒì•„ê°€ë©´ì„œ ì‚¬ëƒ¥í•œ ê°ë„ë¥¼ ë³´ê³ , <strong>ë” ê°€ê¹Œìš´ ì¹œêµ¬ ì°¾ê¸°</strong> ê²½ìŸì„ í•  ìˆ˜ ìˆì–´ìš”.</li>
        <li>ëª©í‘œ ê°ë„ë¥¼ 90Â°, 45Â°, 135Â° ë“±ìœ¼ë¡œ ì¼ë¶€ëŸ¬ ì„¤ì •í•´ ë‘ê³  <strong>â€œê¸°ì¤€ ê°ë„â€ ê°ê°ì„ ì¡ê²Œ</strong> ë„ì™€ì¤„ ìˆ˜ ìˆì–´ìš”.</li>
        <li>â€œì˜¤ëŠ˜ í‰ê·  ì˜¤ì°¨ê°€ 10Â° ì´í•˜ë©´ ìš°ë¦¬ ë°˜ ê°ë„ ë§ˆìŠ¤í„°!â€ ê°™ì´ <strong>í•™ê¸‰ ë¯¸ì…˜</strong>ì„ ì •í•´ë„ ì¢‹ì•„ìš”.</li>
      </ul>

      <div class="badge-row">
        <div class="badge">ğŸ“ <strong>ìˆ˜í•™ 4í•™ë…„ ê°ë„ ë‹¨ì›</strong>ê³¼ ì—°ê³„</div>
        <div class="badge">ğŸ§  ì§ê´€ì  ì¶”ë¡  Â· ìˆ˜ ê°ê°</div>
      </div>

      <div class="score-badge" id="scoreBadge">
        ğŸŒŸ ì˜¤ëŠ˜ì˜ ëˆ„ì  ê¸°ë¡: <span id="scoreDetail">ì•„ì§ ê¸°ë¡ì´ ì—†ì–´ìš”.</span>
      </div>
    </aside>
  </main>

  <script>
    const canvas = document.getElementById("angleCanvas");
    const ctx = canvas.getContext("2d");

    const slider = document.getElementById("angleSlider");
    const currentAngleLabel = document.getElementById("currentAngleLabel");
    const targetAngleText = document.getElementById("targetAngleText");
    const statusBox = document.getElementById("statusBox");
    const statusTitle = document.getElementById("statusTitle");
    const statusText = document.getElementById("statusText");
    const statusDiff = document.getElementById("statusDiff");
    const statusScore = document.getElementById("statusScore");
    const statusEmoji = document.getElementById("statusEmoji");
    const scoreDetail = document.getElementById("scoreDetail");
    const scoreBadge = document.getElementById("scoreBadge");

    const btnNew = document.getElementById("btnNew");
    const btnCheck = document.getElementById("btnCheck");
    const btnShowAnswer = document.getElementById("btnShowAnswer");
    const btnResetRound = document.getElementById("btnResetRound");

    const difficultyGroup = document.getElementById("difficultyGroup");

    let targetAngle = null;
    let currentAngle = 0;
    let showTarget = false;
    let roundCount = 0;
    let totalDiff = 0;

    function setDifficultyActive(value) {
      const chips = difficultyGroup.querySelectorAll(".chip");
      chips.forEach(chip => {
        const input = chip.querySelector("input");
        if (input.value === value) chip.classList.add("active");
        else chip.classList.remove("active");
      });
    }

    difficultyGroup.addEventListener("click", e => {
      const chip = e.target.closest(".chip");
      if (!chip) return;
      const input = chip.querySelector("input");
      if (!input) return;
      setDifficultyActive(input.value);
      input.checked = true;
      newMission();
    });

    function getCurrentDifficulty() {
      const checked = difficultyGroup.querySelector("input[name='difficulty']:checked");
      return checked ? checked.value : "easy";
    }

    function getRandomTargetAngle() {
      const diff = getCurrentDifficulty();
      let baseUnit = 10;
      if (diff === "normal") baseUnit = 5;
      else if (diff === "hard") baseUnit = 1;

      const min = 10;
      const max = 170;

      if (baseUnit === 1) {
        return Math.floor(Math.random() * (max - min + 1)) + min;
      } else {
        const start = Math.ceil(min / baseUnit);
        const end = Math.floor(max / baseUnit);
        const n = Math.floor(Math.random() * (end - start + 1)) + start;
        return n * baseUnit;
      }
    }

    function describeAngle(angle) {
      if (angle === 90) return "ì§ê°";
      if (angle < 90) return "ì˜ˆê°";
      return "ë‘”ê°";
    }

    function drawAngle() {
      const w = canvas.width;
      const h = canvas.height;

      ctx.clearRect(0, 0, w, h);

      ctx.fillStyle = "rgba(148, 163, 184, 0.12)";
      ctx.beginPath();
      ctx.arc(w / 2, h * 0.65, 120, Math.PI, 2 * Math.PI);
      ctx.fill();

      const baseX = w / 2;
      const baseY = h * 0.65;

      const radius = 110;

      const baseAngleRad = Math.PI;

      const currentRad = baseAngleRad - (currentAngle * Math.PI) / 180;
      const targetRad = targetAngle != null
        ? baseAngleRad - (targetAngle * Math.PI) / 180
        : null;

      ctx.lineCap = "round";

      ctx.strokeStyle = "#9ca3af";
      ctx.lineWidth = 4;
      ctx.beginPath();
      ctx.moveTo(baseX, baseY);
      ctx.lineTo(
        baseX + radius * Math.cos(baseAngleRad),
        baseY + radius * Math.sin(baseAngleRad)
      );
      ctx.stroke();

      if (showTarget && targetRad != null) {
        ctx.strokeStyle = "#fb7185";
        ctx.lineWidth = 4;
        ctx.setLineDash([6, 6]);
        ctx.beginPath();
        ctx.moveTo(baseX, baseY);
        ctx.lineTo(
          baseX + radius * Math.cos(targetRad),
          baseY + radius * Math.sin(targetRad)
        );
        ctx.stroke();
        ctx.setLineDash([]);
      }

      ctx.strokeStyle = "#6366f1";
      ctx.lineWidth = 5;
      ctx.beginPath();
      ctx.moveTo(baseX, baseY);
      ctx.lineTo(
        baseX + radius * Math.cos(currentRad),
        baseY + radius * Math.sin(currentRad)
      );
      ctx.stroke();

      ctx.beginPath();
      const arcRadius = 30;
      const startArc = currentRad < baseAngleRad ? currentRad : baseAngleRad;
      const endArc = currentRad < baseAngleRad ? baseAngleRad : currentRad;
      ctx.arc(baseX, baseY, arcRadius, startArc, endArc);
      ctx.strokeStyle = "rgba(129, 140, 248, 0.9)";
      ctx.lineWidth = 3;
      ctx.stroke();

      ctx.fillStyle = "#111827";
      ctx.font = "bold 16px Pretendard, system-ui, sans-serif";
      ctx.textAlign = "center";
      ctx.fillText("ê¸°ì¤€ì„ ", baseX - radius / 2, baseY + 24);

      ctx.font = "13px Pretendard, system-ui, sans-serif";
      ctx.fillStyle = "#4b5563";
      ctx.fillText("0Â° (ê¸°ì¤€)", baseX + radius * Math.cos(baseAngleRad) + 12, baseY + 4);

      const guideAngles = [30, 60, 90, 120, 150];
      ctx.fillStyle = "#9ca3af";
      ctx.font = "11px Pretendard, system-ui, sans-serif";
      guideAngles.forEach(a => {
        const rad = baseAngleRad - (a * Math.PI) / 180;
        const gx = baseX + (radius - 20) * Math.cos(rad);
        const gy = baseY + (radius - 20) * Math.sin(rad);
        ctx.beginPath();
        ctx.arc(gx, gy, 2.5, 0, 2 * Math.PI);
        ctx.fill();
      });
    }

    function updateCurrentAngleFromSlider() {
      currentAngle = parseInt(slider.value, 10) || 0;
      currentAngleLabel.textContent = `${currentAngle}Â°`;
      drawAngle();
    }

    slider.addEventListener("input", () => {
      updateCurrentAngleFromSlider();
      if (targetAngle == null) {
        statusTitle.textContent = "ì¢‹ì•„ìš”! ê°ë„ë¥¼ í•œ ë²ˆ ë§Œë“¤ì–´ ë³¼ê¹Œìš”?";
        statusText.textContent =
          "ì´ì œ 'ìƒˆ ë¯¸ì…˜'ì„ ëˆŒëŸ¬ ì‹¤ì œ ëª©í‘œ ê°ë„ì— ë„ì „í•´ ë³´ì„¸ìš”.";
        statusEmoji.textContent = "âœ¨";
      }
    });

    function newMission() {
      targetAngle = getRandomTargetAngle();
      showTarget = false;
      slider.value = "0";
      currentAngle = 0;
      currentAngleLabel.textContent = "0Â°";
      targetAngleText.innerHTML =
        `ğŸ¯ ëª©í‘œ ê°ë„: <span class="big">${targetAngle}Â°</span> ` +
        `(<span class="highlight">${describeAngle(targetAngle)}</span>)`;
      statusTitle.textContent = "ìƒˆ ë¯¸ì…˜! ëª©í‘œ ê°ë„ë¥¼ ì‚¬ëƒ¥í•´ ë³´ì„¸ìš”!";
      statusText.textContent =
        "ìŠ¬ë¼ì´ë”ë¥¼ ì›€ì§ì—¬ ë‚´ê°€ ë§Œë“  ê°ë„ë¥¼ ì¡°ì ˆí•œ ë’¤, 'ì •ë‹µ í™•ì¸' ë²„íŠ¼ì„ ëˆŒëŸ¬ ë³´ì„¸ìš”.";
      statusEmoji.textContent = "ğŸ¯";
      statusDiff.textContent = "â€”";
      drawAngle();
    }

    function resetRound() {
      if (targetAngle == null) {
        slider.value = "0";
        currentAngle = 0;
        currentAngleLabel.textContent = "0Â°";
        showTarget = false;
        statusTitle.textContent = "ìŠ¬ë¼ì´ë”ë¥¼ ì›€ì§ì—¬ ê°ë„ë¥¼ ë§Œë“¤ì–´ ë³´ì„¸ìš”!";
        statusText.textContent =
          "ëª©í‘œ ê°ë„ê°€ ì„¤ì •ë˜ë©´, ì •ë§ ë¹„ìŠ·í•œì§€ ëˆˆìœ¼ë¡œë„ ë¹„êµí•´ ë³´ì„¸ìš”.";
        statusEmoji.textContent = "ğŸ’¡";
        statusDiff.textContent = "â€”";
      } else {
        slider.value = "0";
        currentAngle = 0;
        currentAngleLabel.textContent = "0Â°";
        showTarget = false;
        statusTitle.textContent = "ì´ë²ˆ íŒ ë‹¤ì‹œ! ë‹¤ì‹œ í•œ ë²ˆ ë„ì „í•´ ë³´ì„¸ìš”!";
        statusText.textContent =
          "ë‹¤ì‹œ 0Â°ì—ì„œ ì‹œì‘í–ˆì–´ìš”. ì´ë²ˆì—ëŠ” ëª©í‘œ ê°ë„ì— ë” ê°€ê¹Œì›Œì§ˆ ìˆ˜ ìˆì„ê¹Œìš”?";
        statusEmoji.textContent = "ğŸ”";
        statusDiff.textContent = "â€”";
      }
      drawAngle();
    }

    function checkAnswer() {
      if (targetAngle == null) {
        statusTitle.textContent = "ë¨¼ì € 'ìƒˆ ë¯¸ì…˜'ì„ ëˆŒëŸ¬ ì£¼ì„¸ìš”!";
        statusText.textContent =
          "ëª©í‘œ ê°ë„ê°€ ìˆì–´ì•¼ ì •ë‹µì„ í™•ì¸í•  ìˆ˜ ìˆì–´ìš”. ìƒˆ ë¯¸ì…˜ì„ ë§Œë“¤ì–´ ì£¼ì„¸ìš”.";
        statusEmoji.textContent = "âš ï¸";
        return;
      }

      const diff = Math.abs(currentAngle - targetAngle);
      totalDiff += diff;
      roundCount++;

      let message = "";
      let title = "";
      let emoji = "";
      let className = "";

      if (diff <= 3) {
        title = "ì™„ë²½í•´ìš”! ê°ë„ ì‚¬ëƒ¥ ì²œì¬! âœ¨";
        message = `ì˜¤ì°¨ê°€ ${diff.toFixed(1)}Â°ë°–ì— ì•ˆ ë‚˜ìš”. ì •ë§ ëŒ€ë‹¨í•´ìš”!`;
        emoji = "ğŸ†";
        className = "status-good";
      } else if (diff <= 7) {
        title = "ê±°ì˜ ì •ë‹µ! ì¡°ê¸ˆë§Œ ë”~ ğŸ’ª";
        message = `ì˜¤ì°¨ëŠ” ì•½ ${diff.toFixed(1)}Â°. ì–´ëŠ ìª½ìœ¼ë¡œ ì¡°ê¸ˆ ë” ëŒë¦¬ë©´ ë ì§€ ìƒê°í•´ ë³¼ê¹Œìš”?`;
        emoji = "ğŸ‘";
        className = "status-okay";
      } else {
        title = "ê´œì°®ì•„ìš”, ë‹¤ì‹œ ë„ì „í•´ìš”! ğŸ”";
        message = `ì˜¤ì°¨ëŠ” ì•½ ${diff.toFixed(1)}Â°. ì˜ˆê°ì¸ì§€, ë‘”ê°ì¸ì§€ë¶€í„° ë‹¤ì‹œ ì‚´í´ë³´ëŠ” ê²ƒë„ ì¢‹ì•„ìš”.`;
        emoji = "ğŸŒ±";
        className = "status-bad";
      }

      statusTitle.textContent = title;
      statusEmoji.textContent = emoji;
      statusText.textContent = message;
      statusDiff.innerHTML = `<span class="${className}">Â± ${diff.toFixed(1)}Â°</span>`;
      statusScore.textContent = `${roundCount}íŒ ì§„í–‰`;

      const avgDiff = totalDiff / roundCount;
      scoreDetail.textContent = `ì´ ${roundCount}íŒ, í‰ê·  ì˜¤ì°¨ ì•½ ${avgDiff.toFixed(1)}Â°.`;
      drawAngle();
    }

    function toggleShowAnswer() {
      if (targetAngle == null) {
        statusTitle.textContent = "ë¨¼ì € 'ìƒˆ ë¯¸ì…˜'ì„ ëˆŒëŸ¬ ì£¼ì„¸ìš”!";
        statusText.textContent = "ì •ë‹µ ê°ë„ë¥¼ ë³´ë ¤ë©´, ë¨¼ì € ëª©í‘œ ê°ë„ê°€ ìˆì–´ì•¼ í•´ìš”.";
        statusEmoji.textContent = "âš ï¸";
        return;
      }
      showTarget = !showTarget;
      drawAngle();

      if (showTarget) {
        statusTitle.textContent = "ë¶„í™ìƒ‰ ì„ ì´ ì •ë‹µ ê°ë„ì˜ˆìš”!";
        statusText.textContent =
          "ë‚´ê°€ ë§Œë“  ê°ë„ì™€ ì •ë‹µ ê°ë„ê°€ ì–¼ë§ˆë‚˜ ì°¨ì´ ë‚˜ëŠ”ì§€ ëˆˆìœ¼ë¡œ ë¹„êµí•´ ë³´ì„¸ìš”.";
        statusEmoji.textContent = "ğŸ‘";
      } else {
        statusTitle.textContent = "ì •ë‹µ ì„ ì„ ìˆ¨ê²¼ì–´ìš”.";
        statusText.textContent =
          "ë‹¤ì‹œ í•œ ë²ˆ ìŠ¤ìŠ¤ë¡œ ê°ë„ë¥¼ ì¶”ì¸¡í•´ ë³´ê³  ì •ë‹µì— ë„ì „í•´ ë³´ì„¸ìš”!";
        statusEmoji.textContent = "ğŸ™ˆ";
      }
    }

    btnNew.addEventListener("click", newMission);
    btnCheck.addEventListener("click", checkAnswer);
    btnShowAnswer.addEventListener("click", toggleShowAnswer);
    btnResetRound.addEventListener("click", resetRound);

    updateCurrentAngleFromSlider();
    drawAngle();
  </script>
</body>
</html>
